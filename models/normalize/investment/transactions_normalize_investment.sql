 {{  config(alias='transactions', database='normalize', schema='investment')  }} 


SELECT
 amount as investment_transactions_amount
,amountvalue as investment_transactions_amountvalue
,amount_type as investment_transactions_amount_type
,approval_by as investment_transactions_approval_by
,approval_by_tier1 as investment_transactions_approval_by_tier1
,approval_by_tier2 as investment_transactions_approval_by_tier2
,approval_date as investment_transactions_approval_date
,approval_date_tier1 as investment_transactions_approval_date_tier1
,approval_date_tier2 as investment_transactions_approval_date_tier2
,approval_status as investment_transactions_approval_status
,approval_tier as investment_transactions_approval_tier
,approval_verify_by as investment_transactions_approval_verify_by
,approval_verify_date as investment_transactions_approval_verify_date
,approval_verify_flag as investment_transactions_approval_verify_flag
,asof_date as investment_transactions_asof_date
,average_cost as investment_transactions_average_cost
,beartempcode as investment_transactions_beartempcode
,bulkapprovalflag as investment_transactions_bulkapprovalflag
,bulkqcflag as investment_transactions_bulkqcflag
,canceltrxcode as investment_transactions_canceltrxcode
,cancel_flag as investment_transactions_cancel_flag
,cdc_operation as investment_transactions_cdc_operation
,certificate as investment_transactions_certificate
,changedby as investment_transactions_changedby
,changedon as investment_transactions_changedon
,chequelink as investment_transactions_chequelink
,clawback as investment_transactions_clawback
,clientinstruction as investment_transactions_clientinstruction
,clientrorflag as investment_transactions_clientrorflag
,code as investment_transactions_code
,commchkgrp as investment_transactions_commchkgrp
,commission_paid_date as investment_transactions_commission_paid_date
,commission_rate as investment_transactions_commission_rate
,commission_receive_date as investment_transactions_commission_receive_date
,commission_reconciled_date as investment_transactions_commission_reconciled_date
,commit_timestamp as investment_transactions_commit_timestamp
,comm_run_code as investment_transactions_comm_run_code
,compliancelevel as investment_transactions_compliancelevel
,confirmation_date as investment_transactions_confirmation_date
,confirmation_number as investment_transactions_confirmation_number
,contributioncode as investment_transactions_contributioncode
,contributionperiod as investment_transactions_contributionperiod
,css_paid as investment_transactions_css_paid
,currencyname as investment_transactions_currencyname
,datalake_end_ts as investment_transactions_datalake_end_ts
,datalake_start_ts as investment_transactions_datalake_start_ts
,datalake_timestamp as investment_transactions_datalake_timestamp
,date_created as investment_transactions_date_created
,dbx_old_aquisition as investment_transactions_dbx_old_aquisition
,dbx_old_client_code as investment_transactions_dbx_old_client_code
,dbx_old_commission as investment_transactions_dbx_old_commission
,dbx_old_c_type as investment_transactions_dbx_old_c_type
,dbx_old_dsc_pct as investment_transactions_dbx_old_dsc_pct
,dbx_old_fundaccount_code as investment_transactions_dbx_old_fundaccount_code
,dbx_old_net_gross as investment_transactions_dbx_old_net_gross
,dbx_old_order_key as investment_transactions_dbx_old_order_key
,dbx_old_prodfamily as investment_transactions_dbx_old_prodfamily
,dbx_old_prodkey as investment_transactions_dbx_old_prodkey
,dbx_old_reg_num as investment_transactions_dbx_old_reg_num
,dbx_old_settle_src as investment_transactions_dbx_old_settle_src
,dbx_old_source as investment_transactions_dbx_old_source
,dbx_old_stime as investment_transactions_dbx_old_stime
,dbx_old_tns_num as investment_transactions_dbx_old_tns_num
,dbx_old_trx_code as investment_transactions_dbx_old_trx_code
,dbx_old_trx_exchange_code as investment_transactions_dbx_old_trx_exchange_code
,dbx_ord_cus_search_id as investment_transactions_dbx_ord_cus_search_id
,dealer_commission as investment_transactions_dealer_commission
,deposit_date as investment_transactions_deposit_date
,docreqdflg as investment_transactions_docreqdflg
,docreqdsentflg as investment_transactions_docreqdsentflg
,docreqsentby as investment_transactions_docreqsentby
,docreqsenton as investment_transactions_docreqsenton
,dsc as investment_transactions_dsc
,enteredby as investment_transactions_enteredby
,enteredtrade as investment_transactions_enteredtrade
,est_commission as investment_transactions_est_commission
,exchangerate as investment_transactions_exchangerate
,exchange_code as investment_transactions_exchange_code
,exchange_flag as investment_transactions_exchange_flag
,exec_charge as investment_transactions_exec_charge
,export_status as investment_transactions_export_status
,exp_msglist as investment_transactions_exp_msglist
,exp_returncode as investment_transactions_exp_returncode
,exp_returntime as investment_transactions_exp_returntime
,ext_type_code as investment_transactions_ext_type_code
,fee as investment_transactions_fee
,feedetails as investment_transactions_feedetails
,fee_rep_id as investment_transactions_fee_rep_id
,fstrade as investment_transactions_fstrade
,fstrxtype as investment_transactions_fstrxtype
,fstrxtypedetail as investment_transactions_fstrxtypedetail
,fundaccount_code as investment_transactions_fundaccount_code
,fundaccount_number as investment_transactions_fundaccount_number
,fundfactscompliant as investment_transactions_fundfactscompliant
,fundproduct_code as investment_transactions_fundproduct_code
,fundproduct_fundid as investment_transactions_fundproduct_fundid
,fundproduct_fundnumber as investment_transactions_fundproduct_fundnumber
,fundproduct_fundsubtype as investment_transactions_fundproduct_fundsubtype
,fundproduct_fundtype as investment_transactions_fundproduct_fundtype
,fundproduct_name as investment_transactions_fundproduct_name
,fundproduct_risktolerance as investment_transactions_fundproduct_risktolerance
,gst_hst as investment_transactions_gst_hst
,ho_commission as investment_transactions_ho_commission
,ho_ticket_charge as investment_transactions_ho_ticket_charge
,importfilecode as investment_transactions_importfilecode
,importtempcode as investment_transactions_importtempcode
,import_date as investment_transactions_import_date
,import_source as investment_transactions_import_source
,import_ticket_charge as investment_transactions_import_ticket_charge
,issued_shares as investment_transactions_issued_shares
,is_first_known_record as investment_transactions_is_first_known_record
,is_last_known_record as investment_transactions_is_last_known_record
,lastupdated as investment_transactions_lastupdated
,last_modify_date as investment_transactions_last_modify_date
,lsiffedtaxcredit as investment_transactions_lsiffedtaxcredit
,lsifprovtaxcredit as investment_transactions_lsifprovtaxcredit
,manager_override as investment_transactions_manager_override
,manualentryflag as investment_transactions_manualentryflag
,manufacturerprocessingdate as investment_transactions_manufacturerprocessingdate
,mergedbytool as investment_transactions_mergedbytool
,multiple_flag as investment_transactions_multiple_flag
,netsetleind as investment_transactions_netsetleind
,net_amount as investment_transactions_net_amount
,nm_flag as investment_transactions_nm_flag
,nosignatureflag as investment_transactions_nosignatureflag
,note as investment_transactions_note
,noteflag as investment_transactions_noteflag
,orderid as investment_transactions_orderid
,order_time as investment_transactions_order_time
,originaldataid as investment_transactions_originaldataid
,paymentid as investment_transactions_paymentid
,payment_status as investment_transactions_payment_status
,pretradedisclosure as investment_transactions_pretradedisclosure
,pre_setlement_date as investment_transactions_pre_setlement_date
,problems_warnings as investment_transactions_problems_warnings
,processtype as investment_transactions_processtype
,productind as investment_transactions_productind
,qc_by as investment_transactions_qc_by
,qc_date as investment_transactions_qc_date
,qc_status as investment_transactions_qc_status
,quickdetailcode as investment_transactions_quickdetailcode
,quickdetailflag as investment_transactions_quickdetailflag
,rebill_code as investment_transactions_rebill_code
,recheck as investment_transactions_recheck
,recheck_date as investment_transactions_recheck_date
,reconcile_flag as investment_transactions_reconcile_flag
,registration_source as investment_transactions_registration_source
,reg_code as investment_transactions_reg_code
,rep_code as investment_transactions_rep_code
,reverse_flag as investment_transactions_reverse_flag
,ror as investment_transactions_ror
,segdbgro as investment_transactions_segdbgro
,segdbgro_fundid as investment_transactions_segdbgro_fundid
,seglibpo as investment_transactions_seglibpo
,seglibpo_fundid as investment_transactions_seglibpo_fundid
,segmaturityguaranteedate as investment_transactions_segmaturityguaranteedate
,segmgro as investment_transactions_segmgro
,segmgro_fundid as investment_transactions_segmgro_fundid
,seq as investment_transactions_seq
,service_charge as investment_transactions_service_charge
,setlement_date::date as investment_transactions_setlement_date
,settlementamount as investment_transactions_settlementamount
,settlement_period as investment_transactions_settlement_period
,shares_units as investment_transactions_shares_units
,share_balance_after as investment_transactions_share_balance_after
,signingprovince as investment_transactions_signingprovince
,sourceoffunds as investment_transactions_sourceoffunds
,sourceofmoney as investment_transactions_sourceofmoney
,source_number as investment_transactions_source_number
,sponsor_code as investment_transactions_sponsor_code
,spousal_flag as investment_transactions_spousal_flag
,stage_id as investment_transactions_stage_id
,stop_status as investment_transactions_stop_status
,stream_position as investment_transactions_stream_position
,suspiciousflag as investment_transactions_suspiciousflag
,sync_flag as investment_transactions_sync_flag
,taxcode as investment_transactions_taxcode
,taxcollected as investment_transactions_taxcollected
,taxevent as investment_transactions_taxevent
,taxeventind as investment_transactions_taxeventind
,taxjurisdiction as investment_transactions_taxjurisdiction
,tc_fee as investment_transactions_tc_fee
,ticket_charge as investment_transactions_ticket_charge
,tradeblotterflag as investment_transactions_tradeblotterflag
,trade_date::date as investment_transactions_trade_date
,transaction_date_type as investment_transactions_transaction_date_type
,transaction_flag as investment_transactions_transaction_flag
,transaction_type as investment_transactions_transaction_type
,transact_id as investment_transactions_transact_id
,type as investment_transactions_type
,unissued_shares as investment_transactions_unissued_shares
,unit_price as investment_transactions_unit_price
,wht1 as investment_transactions_wht1
,wht2 as investment_transactions_wht2
,wizard_compliance_flag as investment_transactions_wizard_compliance_flag
,wizard_com_flag as investment_transactions_wizard_com_flag
,wizard_integrity_flag as investment_transactions_wizard_integrity_flag
,wizard_trade_approval_flag as investment_transactions_wizard_trade_approval_flag
,wizard_unsettled_flag as investment_transactions_wizard_unsettled_flag
,ws_trxcode as investment_transactions_ws_trxcode
,_infx_loaded_ts_utc 
,_infx_active_from_ts_utc 
,_infx_active_to_ts_utc  
,_infx_is_active 
  


from {{ ref ('transactions_clean_investment')  }}