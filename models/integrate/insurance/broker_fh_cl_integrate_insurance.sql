{{			
    config (			
        materialized="view",			
        alias='broker_fh_cl', 			
        database='integrate', 			
        schema='insurance',
        grants = {'ownership': ['FH_READER']},			
    )			
}}

SELECT 
    PARENTNODEID,
    CAST(agentcode AS VARCHAR) as AGENTCODE,
    FIRSTNAME,
    MIDDLENAME,
    LASTNAME,
    AGENTNAME, 
    CAST (Null as varchar) as CL_Advisor_Group_Identifier, 
    COMPANYNAME,
    CAST(MGACODE AS Number) as MGACODE,
    CAST(AGACODE AS Number) as AGACODE,
    CAST(DATEOFBIRTH AS timestamp) as DATEOFBIRTH,
    PROVINCE,
    COMPANYPROVINCE,
    AGENTSTATUS,
    AGENTTYPE,
    LANGUAGEPREFERENCE,
    SERVICELEVEL,
    CAST(CREATEDDATE AS timestamp) as CREATEDDATE,
    BROKERID,
    CAST(LASTMODIFIEDDATE AS timestamp) as LASTMODIFIEDDATE,
    USERDEFINED2,
    EMAIL,
    CASLAPPROVED,
    SEGMENTA,
    SEGMENTB,
    SEGMENTC,
    SEGMENTTAGWS,
    AAP_TAG,
    ADSL_TAG,
    ELEVATED,
    PENDINGTERMINATION,
    TERMINATED,
    TRANSFERRINGOUT,
    COS_SALES_RSC,
    COS_SALES_BDC,
    COS_SALES_BDD,
    COS_SALES_SVP,
    COS_SALES_RVP,
    COS_SALES_VP,
    COS_CONTRACT_CC,
    COS_CONTRACT_CS,
    COS_COMPLIANCE_RCM,
    COS_OPS_BOC,
    COS_OPS_NBS_INV,
    COS_OPS_NBS_CM,
    COS_OPS_NBS_INF,
    COS_OPS_ROM,
    COS_RAM,
    COS_SALESIS,
    COS_SALES_WS,
    COS_OPS_RMO,
    COS_CONTRACT_RMCC
FROM {{ ref('broker_fh_integrate_insurance') }}

UNION

SELECT 
    CAST(NULL AS VARCHAR) AS PARENTNODEID, 
    CAST(agentcode AS VARCHAR) AS agentcode, 
    CAST(NULL AS VARCHAR) AS FIRSTNAME, 
    CAST(NULL AS VARCHAR) AS MIDDLENAME, 
    CAST(NULL AS VARCHAR) AS LASTNAME, 
    CAST(AGENTNAME AS VARCHAR) AS AGENTNAME, 
    CL_Advisor_Group_Identifier,
    CAST(COMPANYNAME AS VARCHAR) AS COMPANYNAME, 
    CAST(NULL AS Number) AS MGACODE, 
    CAST(NULL AS Number) AS AGACODE, 
    CAST(NULL AS timestamp) AS DATEOFBIRTH, 
    CAST(PROVINCE AS VARCHAR) AS PROVINCE, 
    CAST(NULL AS VARCHAR) AS COMPANYPROVINCE, 
    CAST(AGENTSTATUS AS VARCHAR) AS AGENTSTATUS, 
    CAST(NULL AS VARCHAR) AS AGENTTYPE, 
    CAST(LANGUAGEPREFERENCE AS VARCHAR) AS LANGUAGEPREFERENCE, 
    CAST(NULL AS VARCHAR) AS SERVICELEVEL,
    cast(CREATEDDATE AS timestamp) as CREATEDDATE, 
    CAST(NULL AS VARCHAR) AS BROKERID, 
    CAST(NULL AS timestamp) AS LASTMODIFIEDDATE, 
    CAST(USERDEFINED2 AS VARCHAR) AS USERDEFINED2, 
    CAST(EMAILADDRESS AS VARCHAR) AS EMAIL, 
    CAST(NULL AS VARCHAR) AS CASLAPPROVED, 
    CAST(NULL AS VARCHAR) AS SEGMENTA, 
    CAST(NULL AS VARCHAR) AS SEGMENTB, 
    CAST(NULL AS VARCHAR) AS SEGMENTC, 
    CASE 
    WHEN SEGMENTS  = 'A' THEN 'Segment A'
    WHEN SEGMENTS  = 'B' THEN 'Segment B'
    WHEN SEGMENTS  = 'C' THEN 'Segment C'
    ELSE SEGMENTS 
  END as SEGMENTTAGWS,
    CAST(NULL AS VARCHAR) AS AAP_TAG, 
    CAST(NULL AS VARCHAR) AS ADSL_TAG, 
    CAST(NULL AS VARCHAR) AS ELEVATED, 
    CAST(NULL AS VARCHAR) AS PENDINGTERMINATION, 
    CAST(NULL AS VARCHAR) AS TERMINATED, 
    CAST(NULL AS VARCHAR) AS TRANSFERRINGOUT, 
    CAST(NULL AS VARCHAR) AS COS_SALES_RSC, 
    CAST(COS_BDC AS VARCHAR) AS COS_SALES_BDC, 
    CAST(COS_BDD AS VARCHAR) AS COS_SALES_BDD, 
    CAST(Null AS VARCHAR) AS COS_SALES_SVP, 
    CAST(COS_RVP AS VARCHAR) AS COS_SALES_RVP, 
    CAST(NULL AS VARCHAR) AS COS_SALES_VP,
    CAST(NULL AS VARCHAR) AS COS_CONTRACT_CC, 
    CAST(NULL AS VARCHAR) AS COS_CONTRACT_CS, 
    CAST(NULL AS VARCHAR) AS COS_COMPLIANCE_RCM, 
    CAST(NULL AS VARCHAR) AS COS_OPS_BOC, 
    CAST(NULL AS VARCHAR) AS COS_OPS_NBS_INV, 
    CAST(NULL AS VARCHAR) AS COS_OPS_NBS_CM, 
    CAST(NULL AS VARCHAR) AS COS_OPS_NBS_INF, 
    CAST(NULL AS VARCHAR) AS COS_OPS_ROM, 
    CAST(NULL AS VARCHAR) AS COS_RAM, 
    CAST(NULL AS VARCHAR) AS COS_SALESIS, 
    CAST(NULL AS VARCHAR) AS COS_SALES_WS,
    CAST(NULL AS VARCHAR) AS COS_OPS_RMO, 
    CAST(NULL AS VARCHAR) AS COS_CONTRACT_RMCC
FROM {{ source('acdirect_broker', 'acdirect_advisor_info_agreement') }}




