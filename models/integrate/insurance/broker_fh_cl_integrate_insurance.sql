{{			
    config (			
        materialized="view",			
        alias='broker_fh_cl', 			
        database='integrate', 			
        schema='insurance',
        grants = {'ownership': ['FH_READER']},			
    )			
}}
SELECT 
    NULL AS PARENTNODEID, 
  CAST(agentcode AS VARCHAR) AS agentcode, 
    NULL AS FIRSTNAME, 
    NULL AS MIDDLENAME, 
    NULL AS LASTNAME, 
    AGENTNAME AS AGENTNAME,  
    COMPANYNAME AS COMPANYNAME, 
    NULL AS MGACODE, 
    NULL AS AGACODE, 
    NULL AS DATEOFBIRTH, 
    PROVINCE AS PROVINCE, 
    NULL AS COMPANYPROVINCE, 
    AGENTSTATUS AS AGENTSTATUS, 
    NULL AS AGENTTYPE, 
    LANGUAGEPREFERENCE AS LANGUAGEPREFERENCE, 
    NULL AS SERVICELEVEL,
    CREATEDDATE AS CREATEDDATE, 
    NULL AS BROKERID, 
    NULL AS LASTMODIFIEDDATE, 
    USERDEFINED2 AS USERDEFINED2, 
    EMAILADDRESS AS EMAIL, 
    NULL AS CASLAPPROVED, 
    NULL AS SEGMENTA, 
    NULL AS SEGMENTB, 
    NULL AS SEGMENTC, 
    SEGMENTS AS SEGMENTTAGWS, 
    NULL AS AAP_TAG, 
    NULL AS ADSL_TAG, 
    NULL AS ELEVATED, 
    NULL AS PENDINGTERMINATION, 
    NULL AS TERMINATED, 
    NULL AS TRANSFERRINGOUT, 
    NULL AS COS_SALES_RSC, 
    COS_BDC AS COS_SALES_BDC, 
    COS_BDD AS COS_SALES_BDD, 
    COS_SVP AS COS_SALES_SVP, 
    COS_RVP AS COS_SALES_RVP, 
    NULL AS COS_SALES_VP,
    NULL AS COS_CONTRACT_CC, 
    NULL AS COS_CONTRACT_CS, 
    NULL AS COS_COMPLIANCE_RCM, 
    NULL AS COS_OPS_BOC, 
    NULL AS COS_OPS_NBS_INV, 
    NULL AS COS_OPS_NBS_CM, 
    NULL AS COS_OPS_NBS_INF, 
    NULL AS COS_OPS_ROM, 
    NULL AS COS_RAM, 
    NULL AS COS_SALESIS, 
    NULL AS COS_SALES_WS,
    NULL AS COS_OPS_RMO, 
    NULL AS COS_CONTRACT_RMCC
FROM {{ source('acdirect_broker', 'ac_direct_advisor_info') }}

UNION

SELECT 
    PARENTNODEID,
    CAST(agentcode AS VARCHAR) as AGENTCODE,
    FIRSTNAME,
    MIDDLENAME,
    LASTNAME,
    AGENTNAME,  
    COMPANYNAME,
    MGACODE,
    AGACODE,
    DATEOFBIRTH,
    PROVINCE,
    COMPANYPROVINCE,
    AGENTSTATUS,
    AGENTTYPE,
    LANGUAGEPREFERENCE,
    SERVICELEVEL,
    CREATEDDATE,
    BROKERID,
    LASTMODIFIEDDATE,
    USERDEFINED2,
    EMAIL,
    CASLAPPROVED,
    SEGMENTA,
    SEGMENTB,
    SEGMENTC,
    SEGMENTTAGWS,
    AAP_TAG,
    ADSL_TAG,
    ELEVATED,
    PENDINGTERMINATION,
    TERMINATED,
    TRANSFERRINGOUT,
    COS_SALES_RSC,
    COS_SALES_BDC,
    COS_SALES_BDD,
    COS_SALES_SVP,
    COS_SALES_RVP,
    COS_SALES_VP,
    COS_CONTRACT_CC,
    COS_CONTRACT_CS,
    COS_COMPLIANCE_RCM,
    COS_OPS_BOC,
    COS_OPS_NBS_INV,
    COS_OPS_NBS_CM,
    COS_OPS_NBS_INF,
    COS_OPS_ROM,
    COS_RAM,
    COS_SALESIS,
    COS_SALES_WS,
    COS_OPS_RMO,
    COS_CONTRACT_RMCC
FROM {{ ref('broker_fh_integrate_insurance') }}
