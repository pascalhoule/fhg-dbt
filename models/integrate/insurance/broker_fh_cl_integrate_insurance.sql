{{			
    config (			
        materialized="view",			
        alias='broker_fh_cl', 			
        database='integrate', 			
        schema='insurance',
        grants = {'ownership': ['FH_READER']},			
    )			
}}
SELECT 
    CAST(NULL AS VARCHAR) AS PARENTNODEID, 
  CAST(agentcode AS VARCHAR) AS agentcode, 
    CAST(NULL AS VARCHAR) AS FIRSTNAME, 
    CAST(NULL AS VARCHAR) AS MIDDLENAME, 
    CAST(NULL AS VARCHAR) AS LASTNAME, 
    AGENTNAME AS AGENTNAME,  
    COMPANYNAME AS COMPANYNAME, 
    CAST(NULL AS VARCHAR) AS MGACODE, 
    CAST(NULL AS VARCHAR) AS AGACODE, 
    CAST(NULL AS VARCHAR) AS DATEOFBIRTH, 
    PROVINCE AS PROVINCE, 
    CAST(NULL AS VARCHAR) AS COMPANYPROVINCE, 
    AGENTSTATUS AS AGENTSTATUS, 
    CAST(NULL AS VARCHAR) AS AGENTTYPE, 
    LANGUAGEPREFERENCE AS LANGUAGEPREFERENCE, 
    CAST(NULL AS VARCHAR) AS SERVICELEVEL,
    CREATEDDATE AS CREATEDDATE, 
    CAST(NULL AS VARCHAR) AS BROKERID, 
    CAST(NULL AS VARCHAR) AS LASTMODIFIEDDATE, 
    USERDEFINED2 AS USERDEFINED2, 
    EMAILADDRESS AS EMAIL, 
    CAST(NULL AS VARCHAR) AS CASLAPPROVED, 
    CAST(NULL AS VARCHAR) AS SEGMENTA, 
    CAST(NULL AS VARCHAR) AS SEGMENTB, 
    CAST(NULL AS VARCHAR) AS SEGMENTC, 
    SEGMENTS AS SEGMENTTAGWS, 
    CAST(NULL AS VARCHAR) AS AAP_TAG, 
    CAST(NULL AS VARCHAR) AS ADSL_TAG, 
    CAST(NULL AS VARCHAR) AS ELEVATED, 
    CAST(NULL AS VARCHAR) AS PENDINGTERMINATION, 
    CAST(NULL AS VARCHAR) AS TERMINATED, 
    CAST(NULL AS VARCHAR) AS TRANSFERRINGOUT, 
    CAST(NULL AS VARCHAR) AS COS_SALES_RSC, 
    COS_BDC AS COS_SALES_BDC, 
    COS_BDD AS COS_SALES_BDD, 
    COS_SVP AS COS_SALES_SVP, 
    COS_RVP AS COS_SALES_RVP, 
    CAST(NULL AS VARCHAR) AS COS_SALES_VP,
    CAST(NULL AS VARCHAR) AS COS_CONTRACT_CC, 
    CAST(NULL AS VARCHAR) AS COS_CONTRACT_CS, 
    CAST(NULL AS VARCHAR) AS COS_COMPLIANCE_RCM, 
    CAST(NULL AS VARCHAR) AS COS_OPS_BOC, 
    CAST(NULL AS VARCHAR) AS COS_OPS_NBS_INV, 
    CAST(NULL AS VARCHAR) AS COS_OPS_NBS_CM, 
    CAST(NULL AS VARCHAR) AS COS_OPS_NBS_INF, 
    CAST(NULL AS VARCHAR) AS COS_OPS_ROM, 
    CAST(NULL AS VARCHAR) AS COS_RAM, 
    CAST(NULL AS VARCHAR) AS COS_SALESIS, 
    CAST(NULL AS VARCHAR) AS COS_SALES_WS,
    CAST(NULL AS VARCHAR) AS COS_OPS_RMO, 
    CAST(NULL AS VARCHAR) AS COS_CONTRACT_RMCC
FROM {{ source('acdirect_broker', 'ac_direct_advisor_info') }}

UNION

SELECT 
    PARENTNODEID,
    CAST(agentcode AS VARCHAR) as AGENTCODE,
    FIRSTNAME,
    MIDDLENAME,
    LASTNAME,
    AGENTNAME,  
    COMPANYNAME,
    MGACODE,
    AGACODE,
    DATEOFBIRTH,
    PROVINCE,
    COMPANYPROVINCE,
    AGENTSTATUS,
    AGENTTYPE,
    LANGUAGEPREFERENCE,
    SERVICELEVEL,
    CREATEDDATE,
    BROKERID,
    LASTMODIFIEDDATE,
    USERDEFINED2,
    EMAIL,
    CASLAPPROVED,
    SEGMENTA,
    SEGMENTB,
    SEGMENTC,
    SEGMENTTAGWS,
    AAP_TAG,
    ADSL_TAG,
    ELEVATED,
    PENDINGTERMINATION,
    TERMINATED,
    TRANSFERRINGOUT,
    COS_SALES_RSC,
    COS_SALES_BDC,
    COS_SALES_BDD,
    COS_SALES_SVP,
    COS_SALES_RVP,
    COS_SALES_VP,
    COS_CONTRACT_CC,
    COS_CONTRACT_CS,
    COS_COMPLIANCE_RCM,
    COS_OPS_BOC,
    COS_OPS_NBS_INV,
    COS_OPS_NBS_CM,
    COS_OPS_NBS_INF,
    COS_OPS_ROM,
    COS_RAM,
    COS_SALESIS,
    COS_SALES_WS,
    COS_OPS_RMO,
    COS_CONTRACT_RMCC
FROM {{ ref('broker_fh_integrate_insurance') }}
