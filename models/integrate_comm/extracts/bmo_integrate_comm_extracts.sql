{{ config(alias='bmo', 
    database='integrate_comm', 
    schema='extracts', 
    materialization = "view",
    grants = {'ownership': ['COMMISION']},)  
}} 

SELECT
    "STMT BASIS AMOUNT" AS STMT_BASIS_AMOUNT,
    "COMMISSION RATE" AS COMMISSION_RATE,
    AMOUNT,
    CURRENCY,
    null AS FUND,
    SHARE,
    FH_FILENAME,
    TRIM(MGA) AS MGA,
    TRIM("FIELD FORCE ID") AS FIELD_FORCE_ID,
    TRIM("BUSINESS FIRST NAME") AS BUSINESS_FIRST_NAME,
    TRIM("BUSINESS SURNAME") AS BUSINESS_SURNAME,
    DATE("GENERATION DT.") AS GENERATION_DT,
    TRIM("BATCH NUMBER") AS BATCH_NUMBER,
    TRIM("COMM. TYPE") AS COMM_TYPE,
    TRIM("COMM. SUBTYPE") AS COMM_SUBTYPE,
    DATE("COMPENSATION DT") AS COMPENSATION_DT,
    TRIM(POLICY) AS POLICY,
    TRIM(COVERAGE) AS COVERAGE,
    TRIM("COV PLAN CODE") AS COV_PLAN_CODE,
    TRIM(DIVISION) AS DIVISION,
    TRIM(LOB) AS LOB,
    TRIM(PRODUCT) AS PRODUCT,
    TRIM(ELEMENT) AS ELEMENT,
    TRIM("FROM/TO ID") AS FROM_TO_ID,
    TRIM("FIRST NAME") AS FIRST_NAME,
    TRIM("LAST NAME") AS LAST_NAME,
    TRIM(REGION) AS REGION,
    TRIM("GENERATION TRANSACTION") AS GENERATION_TRANSACTION,
    TRIM(MEMO) AS MEMO,
    TO_TIMESTAMP(FH_TIMESTAMP) AS FH_TIMESTAMP
FROM {{ source('ren_comm', 'bmo') }}
