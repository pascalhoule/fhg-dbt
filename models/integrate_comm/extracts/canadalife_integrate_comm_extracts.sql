{{ config(alias='canadalife', 
    database='integrate_comm', 
    schema='extracts', 
    materialization = "view",
    grants = {'ownership': ['COMMISSION']},)  
}} 

SELECT
    AMOUNT,
    "SHARE PERCENT" AS SHARE_PERCENT,
    "OVERRIDE COMMISSION AMOUNT" AS OVERRIDE_COMMISSION_AMOUNT,
    "COMMISSIONABLE PREMIUM" AS COMMISSIONABLE_PREMIUM,
    "STATEMENT BASIS AMOUNT" AS STATEMENT_BASIS_AMOUNT,
    "ORIGINAL ADVISOR" AS ORIGINAL_ADVISOR,
    FH_FILENAME,
    FH_TIMESTAMP,
    TRIM(COMPANY) AS COMPANY,
    TRIM("DISTRIBUTOR CODE") AS DISTRIBUTOR_CODE,
    TRIM("AGENT SELLING CODE") AS AGENT_SELLING_CODE,
    TRIM(POLICY) AS POLICY,
    TRIM("FIRST NAME") AS FIRST_NAME,
    TRIM("LAST NAME") AS LAST_NAME,
    DATE(SPLIT_PART("GENERATION DATE", ' ', 1)) AS GENERATION_DATE,
    TRIM("COMMISSION TYPE") AS COMMISSION_TYPE,
    TRIM("COMMISSION SUBTYPE") AS COMMISSION_SUBTYPE,
    TRIM(MODE) AS MODE,
    TRIM("FASAT DIVISION") AS FASAT_DIVISION,
    TRIM("FASAT LINE OF BUSINESS") AS FASAT_LINE_OF_BUSINESS,
    TRIM("FASAT PRODUCT") AS FASAT_PRODUCT,
    TRIM("BASIC PLAN CODE") AS BASIC_PLAN_CODE,
    TRIM("COMMISSION RATE") AS COMMISSION_RATE,
    DATE(SPLIT_PART("PROCESSED DATE", ' ', 1)) AS PROCESSED_DATE,
    TRIM("FROM/TO ADVISOR") AS FROM_TO_ADVISOR,
    TRIM("BUSINESS FIRST NAME") AS BUSINESS_FIRST_NAME,
    TRIM("BUSINESS SURNAME") AS BUSINESS_SURNAME
FROM {{ source('ren_comm', 'canadalife') }}
