{{ config(alias='manulife', 
    database='integrate_comm', 
    schema='extracts', 
    materialization = "view",
    grants = {'ownership': ['COMMISSION']},)  
}}

SELECT
    TRIM(DISTRIBUTOR) AS DISTRIBUTOR, 
    TRIM("GENERATION TRANSACTION") AS GENERATION_TRANSACTION, 
    TRIM("GENERATION ID") AS GENERATION_ID, 
    TRIM(POLICY) AS POLICY, 
    DATE("INFORCE DATE") AS INFORCE_DATE, 
    DATE("GENERATION DATE") AS GENERATION_DATE, 
    TRIM("MANULIFE SELLING CODE") AS MANULIFE_SELLING_CODE, 
    TRIM("COMMISSION TYPE") AS COMMISSION_TYPE, 
    TRIM("COMMISSION SUBTYPE") AS COMMISSION_SUBTYPE, 
    AMOUNT, 
    "SALES CREDIT" AS SALES_CREDIT, 
    "FROM/TO ADVISOR" AS FROM_TO_ADVISOR, 
    "COMMISSION RATE" AS COMMISSION_RATE, 
    TRIM(REMARK) AS REMARK, 
    TRIM("FASAT DIVISION") AS FASAT_DIVISION , 
    "BRANCH CODE" AS BRANCH_CODE, 
    "BATCH NUMBER" AS BATCH_NUMBER, 
    TRIM("ADJUSTMENT TYPE") AS ADJUSTMENT_TYPE, 
    TRIM("FIRST NAME") AS FIRST_NAME, 
    TRIM("LAST NAME") AS LAST_NAME, 
    TRIM("FASAT LINE OF BUSINESS") AS FASAT_LINE_OF_BUSINESS, 
    TRIM("FASAT PRODUCT") AS FASAT_PRODUCT, 
    TRIM("BASIC PLAN CODE") AS BASIC_PLAN_CODE, 
    "COVERAGE PLAN CODE", 
    "SHARE %" AS SHARE_PERCENT, 
    "POLICY COUNT" AS POLICY_COUNT, 
    DURATION, 
    TRIM("ISSUE COUNTRY") AS ISSUE_COUNTRY, 
    TRIM("ISSUE LOCATION") AS ISSUE_LOCATION, 
    TRIM("CURRENT COUNTRY") AS CURRENT_COUNTRY, 
    TRIM("CURRENT LOCATION") AS CURRENT_LOCATION, 
    TRIM("GENERATION SYSTEM") AS GENERATION_SYSTEM, 
    DATE("COMPENSATION DATE") AS COMPENSATION_DATE, 
    TRIM(CURRENCY) AS CURRENCY, 
    DATE("PROCESSED DATE") AS PROCESSED_DATE, 
    SEQUENCE, 
    "OVERRIDE COMMISSION AMOUNT" AS OVERRIDE_COMMISSION_AMOUNT, 
    TRIM("MDRT ELIGIBLE") AS MDRT_ELIGIBLE, 
    "GROSS COMMISSION" AS GROSS_COMMISSION, 
    "DURATION MONTHS" AS DURATION_MONTHS, 
    DATE("DUE DATE") AS DUE_DATE, 
    TRIM(MODE) AS MODE, 
    "COMMISSIONABLE PREMIUM" AS COMMISSIONABLE_PREMIUM, 
    DATE("CREATE DATE") AS CREATE_DATE, 
    TRIM("STAT ACCT") AS STAT_ACCT,  
    "STATEMENT BASIS AMOUNT" AS STATEMENT_BASIS_AMOUNT, 
    TRIM("CARD CODE") AS CARD_CODE,
    TRIM("ORIGINAL ADVISOR") AS ORIGINAL_ADVISOR, 
    TRIM("PAR CODE") AS PAR_CODE, 
    DATE("EFFECTIVE DATE") AS EFFECTIVE_DATE, 
    TRIM("TRANSFERRED?") AS TRANSFERRED, 
    "CHEQUE REFERENCE NUMBER" AS CHEQUE_REFERENCE_NUMBER, 
    TRIM("COMPANY CODE") AS COMPANY_CODE, 
    TRIM("COVERAGE STATUS") AS COVERAGE_STATUS, 
    TRIM("TAXABLE EARNING") AS TAXABLE_EARNING, 
    TRIM("BUSINESS FIRST NAME") AS BUSINESS_FIRST_NAME, 
    TRIM("BUSINESS SURNAME") AS BUSINESS_SURNAME, 
    "RATE MASTER ID" AS RATE_MASTER_ID, 
    "RATE DETAIL ID" AS RATE_DETAIL_ID, 
    DATE("APPLICATION RECEIVED DATE") AS APPLICATION_RECEIVED_DATE,  
    "RATE DURATION" AS RATE_DURATION, 
    TRIM("RATE TERM") AS RATE_TERM, 
    TRIM("RATE BASIS") AS RATE_BASIS, 
    TRIM("COMPENSATION HIERARCHY") AS COMPENSATION_HIERARCHY, 
    TRIM("PLAN RATE SCALE") AS PLAN_RATE_SCALE, 
    TRIM("COVERAGE PLAN RATE SCALE") AS COVERAGE_PLAN_RATE_SCALE, 
    TRIM("LICENCE VALIDATED") AS LICENCE_VALIDATED, 
    TRIM("COMPENSATION STRUCTURE LOOKUP") AS COMPENSATION_STRUCTURE_LOOKUP, 
    TRIM("RATE LOOKUP") AS RATE_LOOKUP, 
    "FUND COMPANY" AS FUND_COMPANY, 
    TRIM("FUND NUMBER") AS FUND_NUMBER, 
    "SPLIT RATE" AS SPLIT_RATE, 
    TRIM("ORIGINAL CURRENCY") AS ORIGINAL_CURRENCY, 
    "ORIGINAL AMOUNT" AS ORIGINAL_AMOUNT, 
    TRIM("SUB ACCOUNT") AS SUB_ACCOUNT, 
    "PREMIUM NUMBER" AS PREMIUM_NUMBER, 
    TRIM("VARIABLE CODE") AS VARIABLE_CODE, 
    TRIM("USER DEPARTMENT/BRANCH ID") AS USER_DEPARTMENT_BRANCH_ID, 
    "CLIENT NUMBER" AS CLIENT_NUMBER, 
    TRIM("JOINT INDICATOR") AS JOINT_INDICATOR, 
    "BASIS SCS" AS BASIS_SCS, 
    "SWEEP RATE" AS SWEEP_RATE, 
    "SWEEP CALCULATOR SALE CREDITS" AS SWEEP_CALCULATOR_SALE_CREDITS, 
    "SWEEP BONUS PAID" AS SWEEP_BONUS_PAID, 
    "SWEEP BONUS EARNED" AS SWEEP_BONUS_EARNED, 
    "EXP SEQ NUMBER" AS EXP_SEQ_NUMBER, 
    TRIM("PENDING ACCOUNT FLAG") AS PENDING_ACCOUNT_FLAG, 
    TRIM("ASSIGNMENT INDICATOR") AS ASSIGNMENT_INDICATOR, 
    TRIM("ASSIGNMENT DONE") AS ASSIGNMENT_DONE, 
    TRIM(AFFILIATE) AS AFFILIATE, 
    TRIM(CORPORATION) AS CORPORATION, 
    TRIM(LOCATION) AS LOCATION, 
    TRIM("ALTERNATE OFFICE") AS ALTERNATE_OFFICE, 
    TRIM(REGION) AS REGION, 
    TRIM(CHANNEL) AS CHANNEL, 
    TRIM(COMPANY) AS COMPANY, 
    TRIM(FH_FILENAME) AS FH_FILENAME, 
    FH_TIMESTAMP
FROM {{ source('ren_comm', 'manulife') }}
